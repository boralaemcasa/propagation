setwd("V:\\sem backup\\_1 OTIMIZACAO MULTIOBJETIVO\\_tc\\ANEXOS\\minimo")
rm(list=ls())

sz <- 500
upper <- 800
maxc <- 150
dsup <- 85
possib <- 100

dist <- function(x, y) { 
   return(sqrt((x[1] - y[1])^2 + (x[2] - y[2])^2)) 
}

fobj <- function(x,clientes,dimini,dimx) {
   f <- 1e69
   f1 <- f
   f2 <- f
   f3 <- f
   N <- x[dimx]
   posicao <- matrix(0, N, 3)
   for (i in 1:N) {
      posicao[i,1] <- x[i]
      posicao[i,2] <- x[i + N]
   }

   # >= 95% * 500 = 475 têm suas demandas integralmente atendidas?
   naoAtendidas <- 0
   atend <- matrix(0, sz, N)
   for (i in 1:sz) {
     clientes[i,4] <- 0
     for (j in 1:N)
        atend[i,j] <- dist(clientes[i,], posicao[j,])
     m <- min(atend[i,])
     # Um cliente pode ser atendido <=> d < 85 metros.
	 if (m >= dsup)
        naoAtendidas <- naoAtendidas + 1
	 else {
        # atender. preencher 4a coluna.
        for (j in 1:N)
	       if (atend[i,j] == m)
		      break
        clientes[i,4] <- j
	 }
   }

   if (naoAtendidas < 0.05 * sz) {
         # Cada ponto tem capacidade de 150 Mbps. Foi excedida?
         excesso <- 1
         somaDistancia <- matrix(0, sz)
         for (j in 1:N)
            posicao[j,3] <- 0
         for (i in 1:sz) {
            j <- clientes[i,4]
            if (j > 0) {
               posicao[j,3] <- posicao[j,3] + clientes[i,3]
               somaDistancia[i] <- atend[i,j]
            }
         }

         f2 <- sqrt(var(somaDistancia))
         f <- f2 * f3
   }
   return(f2)
}

clientes <- as.matrix(read.csv("V:\\sem backup\\_1 OTIMIZACAO MULTIOBJETIVO\\_tc\\clientes.csv", sep=",", header=FALSE))
clientes <- cbind(clientes, 0) # 4a coluna := N

dim1 <- 16
dim2 <- 36
for (dimini in dim1:dim2) {
   depth <- dimini - dim1 + 1
   mat <- as.matrix(read.csv(paste("posicaoDist", toString(dimini), ".csv", sep=""), sep=",", header=FALSE))
   mat <- as.double(mat[2:574,5001])
   print(paste(dimini, fobj(mat,clientes,dimini,573)))
}

######

A <- rbind(c(1,3,3), c(1/3,1,1), c(1/3,1,1))
N <- A
dim <- length(A[,1])
v <- matrix(0, dim)
for (i in 1:dim)
   N[,i] <- A[,i]/sum(A[,i])
N
for (i in 1:dim)
   v[i] <- mean(N[i,])
v
sum(v)


A <- rbind(c(1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7, 9, 9, 9, 9), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1))
   
dim <- length(A[,1])
N <- A
v <- matrix(0, dim)
for (i in 1:dim)
   N[,i] <- A[,i]/sum(A[,i])
N
for (i in 1:dim)
   v[i] <- mean(N[i,])
v
sum(v)
z <- v

w <- matrix(0, dim, dim)

for (i in 1:dim)
   for (k in 1:dim)
      if (v[i] < v[k])
         w[i,k] <- w[i,k] + 100

w

   A <- rbind(c(1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5), c(
   
   1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
    1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/3, 1/3, 1/3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1))
   
v <- matrix(0, dim)
N <- A
for (i in 1:dim)
   N[,i] <- A[,i]/sum(A[,i])
N
for (i in 1:dim)
   v[i] <- mean(N[i,])
v
sum(v)
z <- cbind(z, v)

for (i in 1:dim)
   for (k in 1:dim)
      if (v[i] < v[k])
         w[i,k] <- w[i,k] + 20

A <- rbind(c(1, 1, 1, 1, 3, 3, 5, 5, 5, 7, 7, 7, 5, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 5, 5, 5, 7, 7, 7, 5, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 5, 5, 5, 7, 7, 7, 5, 7, 7, 7, 9, 9, 9, 9), c(
   
   1, 1, 1, 1, 3, 3, 5, 5, 5, 7, 7, 7, 5, 7, 7, 7, 9, 9, 9, 9), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 3, 3, 3, 5, 5, 5, 3, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/3, 1/3, 1/3, 1/3, 1, 1, 3, 3, 3, 5, 5, 5, 3, 5, 5, 5, 7, 7, 7, 7), c(
   
   1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1, 1, 1, 3, 3, 3, 1, 3, 3, 3, 5, 5, 5, 5), c(
   
   1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1, 1, 1, 3, 3, 3, 1, 3, 3, 3, 5, 5, 5, 5), c(
   
   1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1, 1, 1, 3, 3, 3, 1, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/5, 1/5, 1/5, 1/5, 1/3, 1/3, 1, 1, 1, 3, 3, 3, 1, 3, 3, 3, 5, 5, 5, 5), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/7, 1/7, 1/7, 1/7, 1/5, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1/3, 1, 1, 1, 3, 3, 3, 3), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1), c(
   
    1/9, 1/9, 1/9, 1/9, 1/7, 1/7, 1/5, 1/5, 1/5, 1/3, 1/3, 1/3, 1/5, 1/3, 1/3, 1/3, 1, 1, 1, 1))

v <- matrix(0, dim)
N <- A
for (i in 1:dim)
   N[,i] <- A[,i]/sum(A[,i])
N
for (i in 1:dim)
   v[i] <- mean(N[i,])
v
sum(v)
z <- cbind(z, v)

for (i in 1:dim)
   for (k in 1:dim)
      if (v[i] < v[k])
         w[i,k] <- w[i,k] + 3

w

y <- matrix(0, dim, dim)

for (i in 1:dim)
   for (k in 1:dim)
      if (w[i,k] != 0)
         y[i, k] <- max(z[k,] - z[i,]) 

for (i in 1:dim) {
   print(i)
   print(y[i,])
}

s <- matrix(0, dim, dim)

for (i in 1:dim)
   for (k in 1:dim)
      if (y[i,k] <= 0.3)
         s[i, k] <- 1

s
 



